import{n as c,I as l,M as r}from"./index-b17dcd83.js";var d=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"api-auth-container"},[t("div",{staticClass:"page-header"},[t("div",{staticClass:"header-content"},[t("t-button",{attrs:{theme:"default",variant:"text"},on:{click:function(i){return e.$router.back()}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("t-icon",{attrs:{name:"chevron-left"}})]},proxy:!0}])},[e._v(" 返回 ")]),e._m(0)],1)]),t("div",{staticClass:"auth-content"},[t("div",{staticClass:"steps-container"},[t("t-steps",{attrs:{current:e.currentStep,theme:"dot"}},[t("t-step-item",{attrs:{title:"选择应用",content:"选择需要授权的应用"}}),t("t-step-item",{attrs:{title:"选择API",content:"选择需要访问的API接口"}}),t("t-step-item",{attrs:{title:"配置字段",content:"自定义API返回字段"}}),t("t-step-item",{attrs:{title:"提交申请",content:"确认并提交授权申请"}})],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.currentStep===0,expression:"currentStep === 0"}],staticClass:"step-panel"},[e._m(1),t("div",{staticClass:"app-list"},e._l(e.approvedApps,function(i){return t("div",{key:i.id,staticClass:"app-card",class:{selected:e.selectedApp&&e.selectedApp.id===i.id},on:{click:function(s){return e.selectApp(i)}}},[t("div",{staticClass:"app-icon"},[t("t-icon",{attrs:{name:"app",size:"32px"}})],1),t("div",{staticClass:"app-info"},[t("h3",[e._v(e._s(i.name))]),t("p",{staticClass:"app-url"},[e._v(e._s(i.siteUrl))]),t("p",{staticClass:"app-desc"},[e._v(e._s(i.description))]),t("div",{staticClass:"app-meta"},[t("t-tag",{attrs:{theme:"success",size:"small"}},[e._v("已审核")]),t("span",{staticClass:"app-key"},[e._v("AppKey: "+e._s(i.appKey))])],1)]),t("div",{staticClass:"app-select-icon"},[e.selectedApp&&e.selectedApp.id===i.id?t("t-icon",{attrs:{name:"check-circle-filled"}}):e._e()],1)])}),0),t("div",{staticClass:"step-actions"},[t("t-button",{attrs:{theme:"primary",size:"large",disabled:!e.selectedApp},on:{click:e.nextStep}},[e._v(" 下一步 ")])],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.currentStep===1,expression:"currentStep === 1"}],staticClass:"step-panel"},[e._m(2),t("div",{staticClass:"toolbar"},[t("t-input",{staticStyle:{width:"300px"},attrs:{placeholder:"搜索API接口...",clearable:""},scopedSlots:e._u([{key:"prefix-icon",fn:function(){return[t("t-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.apiSearchKeyword,callback:function(i){e.apiSearchKeyword=i},expression:"apiSearchKeyword"}}),t("t-select",{staticStyle:{width:"200px"},attrs:{placeholder:"按业务领域筛选",clearable:""},model:{value:e.selectedCategory,callback:function(i){e.selectedCategory=i},expression:"selectedCategory"}},[t("t-option",{attrs:{value:"all",label:"全部领域"}}),t("t-option",{attrs:{value:"employee",label:"员工管理"}}),t("t-option",{attrs:{value:"organization",label:"组织架构"}}),t("t-option",{attrs:{value:"attendance",label:"考勤管理"}}),t("t-option",{attrs:{value:"compensation",label:"薪酬福利"}}),t("t-option",{attrs:{value:"performance",label:"绩效管理"}}),t("t-option",{attrs:{value:"training",label:"培训发展"}})],1),t("div",{staticClass:"selection-stats"},[e._v(" 已选择 "),t("span",{staticClass:"count"},[e._v(e._s(e.selectedApis.length))]),e._v(" 个API ")])],1),t("div",{staticClass:"api-list"},e._l(e.filteredApiCategories,function(i){return t("div",{key:i.key,staticClass:"api-category"},[t("div",{staticClass:"category-header"},[t("div",{staticClass:"category-title"},[t("t-icon",{attrs:{name:i.icon}}),t("span",[e._v(e._s(i.name))]),t("t-tag",{attrs:{theme:"primary",variant:"light"}},[e._v(e._s(i.apis.length)+" 个API")])],1),t("t-checkbox",{attrs:{checked:e.isCategorySelected(i.key),indeterminate:e.isCategoryIndeterminate(i.key)},on:{change:function(s){return e.toggleCategory(i.key)}}},[e._v(" 全选 ")])],1),t("div",{staticClass:"api-items"},e._l(i.apis,function(s){return t("div",{key:s.id,staticClass:"api-item"},[t("t-checkbox",{attrs:{value:s.id,checked:e.selectedApis.includes(s.id)},on:{change:function(y){return e.toggleApi(s.id)}}},[t("div",{staticClass:"api-item-content"},[t("div",{staticClass:"api-item-header"},[t("span",{staticClass:"api-method",class:s.method},[e._v(e._s(s.method))]),t("span",{staticClass:"api-name"},[e._v(e._s(s.name))])]),t("div",{staticClass:"api-item-desc"},[e._v(e._s(s.description))])])])],1)}),0)])}),0),t("div",{staticClass:"step-actions"},[t("t-button",{attrs:{theme:"default",size:"large"},on:{click:e.prevStep}},[e._v(" 上一步 ")]),t("t-button",{attrs:{theme:"primary",size:"large",disabled:e.selectedApis.length===0},on:{click:e.nextStep}},[e._v(" 下一步 ")])],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.currentStep===2,expression:"currentStep === 2"}],staticClass:"step-panel"},[e._m(3),t("div",{staticClass:"field-config-list"},e._l(e.selectedApis,function(i){return t("div",{key:i,staticClass:"field-config-card"},[e.getApiById(i)?[t("div",{staticClass:"config-card-header"},[t("div",{staticClass:"api-info"},[t("span",{staticClass:"api-method",class:e.getApiById(i).method},[e._v(e._s(e.getApiById(i).method))]),t("span",{staticClass:"api-name"},[e._v(e._s(e.getApiById(i).name))])]),t("t-checkbox",{attrs:{checked:e.isAllFieldsSelected(i),indeterminate:e.isSomeFieldsSelected(i)},on:{change:function(s){return e.toggleAllFields(i)}}},[e._v(" 全选 ")])],1),t("div",{staticClass:"field-list"},[e.apiFieldSelections[i]?t("t-checkbox-group",{model:{value:e.apiFieldSelections[i],callback:function(s){e.$set(e.apiFieldSelections,i,s)},expression:"apiFieldSelections[apiId]"}},[t("div",{staticClass:"field-grid"},e._l(e.getApiById(i).fields,function(s){return t("div",{key:s.name,staticClass:"field-item"},[t("t-checkbox",{attrs:{value:s.name}},[t("div",{staticClass:"field-content"},[t("div",{staticClass:"field-name"},[e._v(" "+e._s(s.name)+" "),s.required?t("t-tag",{attrs:{theme:"danger",size:"small",variant:"light"}},[e._v("必需")]):e._e()],1),t("div",{staticClass:"field-type"},[e._v(e._s(s.type))]),t("div",{staticClass:"field-desc"},[e._v(e._s(s.description))])])])],1)}),0)]):e._e()],1)]:e._e()],2)}),0),t("div",{staticClass:"step-actions"},[t("t-button",{attrs:{theme:"default",size:"large"},on:{click:e.prevStep}},[e._v(" 上一步 ")]),t("t-button",{attrs:{theme:"primary",size:"large"},on:{click:e.nextStep}},[e._v(" 下一步 ")])],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.currentStep===3,expression:"currentStep === 3"}],staticClass:"step-panel"},[e._m(4),t("div",{staticClass:"summary-section"},[t("div",{staticClass:"summary-card"},[t("h3",[e._v("应用信息")]),e.selectedApp?t("div",{staticClass:"summary-content"},[t("div",{staticClass:"summary-item"},[t("span",{staticClass:"label"},[e._v("应用名称：")]),t("span",{staticClass:"value"},[e._v(e._s(e.selectedApp.name))])]),t("div",{staticClass:"summary-item"},[t("span",{staticClass:"label"},[e._v("站点地址：")]),t("span",{staticClass:"value"},[e._v(e._s(e.selectedApp.siteUrl))])]),t("div",{staticClass:"summary-item"},[t("span",{staticClass:"label"},[e._v("AppKey：")]),t("span",{staticClass:"value"},[e._v(e._s(e.selectedApp.appKey))])])]):e._e()]),t("div",{staticClass:"summary-card"},[t("h3",[e._v("API授权列表 ("+e._s(e.selectedApis.length)+"个)")]),t("div",{staticClass:"summary-api-list"},e._l(e.selectedApis,function(i){return t("div",{key:i,staticClass:"summary-api-item"},[e.getApiById(i)?[t("div",{staticClass:"api-header"},[t("span",{staticClass:"api-method",class:e.getApiById(i).method},[e._v(e._s(e.getApiById(i).method))]),t("span",{staticClass:"api-name"},[e._v(e._s(e.getApiById(i).name))])]),t("div",{staticClass:"api-fields"},[t("span",{staticClass:"fields-label"},[e._v("返回字段：")]),e.apiFieldSelections[i]?e._l(e.apiFieldSelections[i],function(s){return t("t-tag",{key:s,attrs:{size:"small",variant:"outline"}},[e._v(" "+e._s(s)+" ")])}):e._e()],2)]:e._e()],2)}),0)])]),t("div",{staticClass:"step-actions"},[t("t-button",{attrs:{theme:"default",size:"large"},on:{click:e.prevStep}},[e._v(" 上一步 ")]),t("t-button",{attrs:{theme:"primary",size:"large",loading:e.submitting},on:{click:e.submitAuthorization}},[t("t-icon",{attrs:{name:"check"}}),e._v(" 提交申请 ")],1)],1)])])])},p=[function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"header-title"},[t("h1",[e._v("接口授权")]),t("p",[e._v("为已通过审核的应用配置API访问权限，并自定义返回字段")])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"panel-header"},[t("h2",[e._v("选择应用")]),t("p",[e._v("请选择一个已通过审核的应用进行API授权")])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"panel-header"},[t("h2",[e._v("选择API接口")]),t("p",[e._v("选择应用需要访问的API接口，支持按业务领域筛选和关键词搜索")])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"panel-header"},[t("h2",[e._v("配置返回字段")]),t("p",[e._v("为每个API选择需要返回的字段，未选择的字段将不会在响应中返回")])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"panel-header"},[t("h2",[e._v("确认授权信息")]),t("p",[e._v("请确认以下授权配置信息，提交后将生效")])])}];const o={name:"ApiAuth",components:{TIcon:l},data(){return{currentStep:0,submitting:!1,selectedApp:null,approvedApps:[{id:"app-001",name:"人力资源管理系统",siteUrl:"https://hr.company.com",description:"企业内部人力资源管理平台，用于员工信息管理、考勤统计、薪资核算等",appKey:"ak_1234567890abcdef",appSecret:"as_abcdef1234567890",status:"approved"},{id:"app-002",name:"移动办公APP",siteUrl:"https://mobile.company.com",description:"移动端办公应用，支持移动打卡、请假审批、工资查询等功能",appKey:"ak_fedcba0987654321",appSecret:"as_0987654321fedcba",status:"approved"},{id:"app-003",name:"数据分析平台",siteUrl:"https://analytics.company.com",description:"企业数据分析平台，用于人力资源数据统计和可视化分析",appKey:"ak_abcd1234efgh5678",appSecret:"as_5678efghabcd1234",status:"approved"}],apiSearchKeyword:"",selectedCategory:"all",selectedApis:[],apiFieldSelections:{},apiCategories:[{key:"employee",name:"员工管理",icon:"user",apis:[{id:"emp-list",method:"GET",name:"/api/employees",description:"获取员工列表",fields:[{name:"id",type:"string",description:"员工ID",required:!0},{name:"name",type:"string",description:"员工姓名",required:!0},{name:"email",type:"string",description:"邮箱地址",required:!1},{name:"phone",type:"string",description:"手机号码",required:!1},{name:"department",type:"string",description:"所属部门",required:!1},{name:"position",type:"string",description:"职位",required:!1},{name:"hireDate",type:"date",description:"入职日期",required:!1},{name:"status",type:"string",description:"员工状态",required:!0}]},{id:"emp-detail",method:"GET",name:"/api/employees/{id}",description:"获取员工详情",fields:[{name:"id",type:"string",description:"员工ID",required:!0},{name:"name",type:"string",description:"员工姓名",required:!0},{name:"email",type:"string",description:"邮箱地址",required:!1},{name:"phone",type:"string",description:"手机号码",required:!1},{name:"department",type:"object",description:"部门信息",required:!1},{name:"position",type:"object",description:"职位信息",required:!1},{name:"hireDate",type:"date",description:"入职日期",required:!1},{name:"birthDate",type:"date",description:"出生日期",required:!1},{name:"address",type:"string",description:"家庭住址",required:!1},{name:"emergencyContact",type:"object",description:"紧急联系人",required:!1},{name:"status",type:"string",description:"员工状态",required:!0}]},{id:"emp-create",method:"POST",name:"/api/employees",description:"创建新员工",fields:[{name:"id",type:"string",description:"员工ID",required:!0},{name:"name",type:"string",description:"员工姓名",required:!0},{name:"message",type:"string",description:"创建结果消息",required:!0}]}]},{key:"organization",name:"组织架构",icon:"chart",apis:[{id:"dept-list",method:"GET",name:"/api/departments",description:"获取部门列表",fields:[{name:"id",type:"string",description:"部门ID",required:!0},{name:"name",type:"string",description:"部门名称",required:!0},{name:"parentId",type:"string",description:"上级部门ID",required:!1},{name:"manager",type:"object",description:"部门负责人",required:!1},{name:"employeeCount",type:"number",description:"员工数量",required:!1},{name:"description",type:"string",description:"部门描述",required:!1}]},{id:"pos-list",method:"GET",name:"/api/positions",description:"获取职位信息",fields:[{name:"id",type:"string",description:"职位ID",required:!0},{name:"title",type:"string",description:"职位名称",required:!0},{name:"level",type:"string",description:"职级",required:!1},{name:"department",type:"string",description:"所属部门",required:!1},{name:"description",type:"string",description:"职位描述",required:!1},{name:"requirements",type:"array",description:"任职要求",required:!1}]}]},{key:"attendance",name:"考勤管理",icon:"time",apis:[{id:"att-records",method:"GET",name:"/api/attendance/records",description:"获取考勤记录",fields:[{name:"id",type:"string",description:"记录ID",required:!0},{name:"employeeId",type:"string",description:"员工ID",required:!0},{name:"employeeName",type:"string",description:"员工姓名",required:!0},{name:"date",type:"date",description:"考勤日期",required:!0},{name:"checkInTime",type:"datetime",description:"签到时间",required:!1},{name:"checkOutTime",type:"datetime",description:"签退时间",required:!1},{name:"status",type:"string",description:"考勤状态",required:!0},{name:"workHours",type:"number",description:"工作时长",required:!1}]},{id:"att-summary",method:"GET",name:"/api/attendance/summary",description:"考勤统计",fields:[{name:"employeeId",type:"string",description:"员工ID",required:!0},{name:"period",type:"string",description:"统计周期",required:!0},{name:"totalDays",type:"number",description:"总天数",required:!0},{name:"workDays",type:"number",description:"出勤天数",required:!0},{name:"absentDays",type:"number",description:"缺勤天数",required:!1},{name:"lateDays",type:"number",description:"迟到天数",required:!1},{name:"leaveDays",type:"number",description:"请假天数",required:!1}]}]},{key:"compensation",name:"薪酬福利",icon:"money-circle",apis:[{id:"sal-info",method:"GET",name:"/api/salary",description:"获取薪资信息",fields:[{name:"employeeId",type:"string",description:"员工ID",required:!0},{name:"period",type:"string",description:"薪资周期",required:!0},{name:"baseSalary",type:"number",description:"基本工资",required:!0},{name:"bonus",type:"number",description:"奖金",required:!1},{name:"allowance",type:"number",description:"津贴",required:!1},{name:"deduction",type:"number",description:"扣款",required:!1},{name:"totalSalary",type:"number",description:"实发工资",required:!0}]}]},{key:"performance",name:"绩效管理",icon:"chart-line",apis:[{id:"perf-reviews",method:"GET",name:"/api/performance/reviews",description:"获取绩效评估",fields:[{name:"id",type:"string",description:"评估ID",required:!0},{name:"employeeId",type:"string",description:"员工ID",required:!0},{name:"period",type:"string",description:"评估周期",required:!0},{name:"score",type:"number",description:"绩效得分",required:!0},{name:"rating",type:"string",description:"绩效等级",required:!0},{name:"reviewer",type:"string",description:"评估人",required:!1},{name:"comments",type:"string",description:"评估意见",required:!1}]}]},{key:"training",name:"培训发展",icon:"education",apis:[{id:"train-courses",method:"GET",name:"/api/training/courses",description:"获取培训课程",fields:[{name:"id",type:"string",description:"课程ID",required:!0},{name:"title",type:"string",description:"课程名称",required:!0},{name:"category",type:"string",description:"课程分类",required:!1},{name:"instructor",type:"string",description:"讲师",required:!1},{name:"duration",type:"number",description:"课程时长",required:!1},{name:"startDate",type:"date",description:"开始日期",required:!1},{name:"capacity",type:"number",description:"容纳人数",required:!1},{name:"enrolled",type:"number",description:"已报名人数",required:!1}]}]}]}},computed:{filteredApiCategories(){let e=this.apiCategories;if(this.selectedCategory&&this.selectedCategory!=="all"&&(e=e.filter(a=>a.key===this.selectedCategory)),this.apiSearchKeyword){const a=this.apiSearchKeyword.toLowerCase();e=e.map(t=>({...t,apis:t.apis.filter(i=>i.name.toLowerCase().includes(a)||i.description.toLowerCase().includes(a))})).filter(t=>t.apis.length>0)}return e}},methods:{selectApp(e){this.selectedApp=e},nextStep(){if(this.currentStep===0&&!this.selectedApp){r.warning("请先选择一个应用");return}if(this.currentStep===1&&this.selectedApis.length===0){r.warning("请至少选择一个API接口");return}this.currentStep===2&&this.selectedApis.forEach(e=>{if(!this.apiFieldSelections[e]){const a=this.getApiById(e);this.$set(this.apiFieldSelections,e,a.fields.filter(t=>t.required).map(t=>t.name))}}),this.currentStep++},prevStep(){this.currentStep--},toggleApi(e){const a=this.selectedApis.indexOf(e);a>-1?(this.selectedApis.splice(a,1),this.$delete(this.apiFieldSelections,e)):this.selectedApis.push(e)},toggleCategory(e){const a=this.apiCategories.find(s=>s.key===e);if(!a)return;const t=a.apis.map(s=>s.id);t.every(s=>this.selectedApis.includes(s))?(this.selectedApis=this.selectedApis.filter(s=>!t.includes(s)),t.forEach(s=>{this.$delete(this.apiFieldSelections,s)})):t.forEach(s=>{this.selectedApis.includes(s)||this.selectedApis.push(s)})},isCategorySelected(e){const a=this.apiCategories.find(i=>i.key===e);if(!a)return!1;const t=a.apis.map(i=>i.id);return t.length>0&&t.every(i=>this.selectedApis.includes(i))},isCategoryIndeterminate(e){const a=this.apiCategories.find(s=>s.key===e);if(!a)return!1;const t=a.apis.map(s=>s.id),i=t.filter(s=>this.selectedApis.includes(s)).length;return i>0&&i<t.length},toggleAllFields(e){const a=this.getApiById(e);if(!a)return;const t=a.fields.map(s=>s.name);(this.apiFieldSelections[e]||[]).length===t.length?this.$set(this.apiFieldSelections,e,a.fields.filter(s=>s.required).map(s=>s.name)):this.$set(this.apiFieldSelections,e,t)},isAllFieldsSelected(e){const a=this.getApiById(e);if(!a)return!1;const t=a.fields.map(s=>s.name);return(this.apiFieldSelections[e]||[]).length===t.length},isSomeFieldsSelected(e){const a=this.getApiById(e);if(!a)return!1;const t=a.fields.map(s=>s.name),i=this.apiFieldSelections[e]||[];return i.length>0&&i.length<t.length},getApiById(e){for(const a of this.apiCategories){const t=a.apis.find(i=>i.id===e);if(t)return t}return null},submitAuthorization(){this.submitting=!0,setTimeout(()=>{r.success({content:"授权申请提交成功！API权限配置已生效",duration:3e3}),this.submitting=!1,setTimeout(()=>{this.$router.push("/")},1500)},1500)}}},n={};var u=c(o,d,p,!1,m,"2388bd26",null,null);function m(e){for(let a in n)this[a]=n[a]}const h=function(){return u.exports}();export{h as default};
